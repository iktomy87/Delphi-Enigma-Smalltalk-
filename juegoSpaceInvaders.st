Morph subclass: #Disparo	instanceVariableNames: 'velocidadProyectil'	classVariableNames: ''	poolDictionaries: ''	category: 'juegoSpaceInvaders'!!Disparo methodsFor: 'as yet unclassified' stamp: 'Tomas 11/15/2024 00:01'!moverself position: (self position + (0 @ -4)). self changed: #bounds.  ! !!Disparo methodsFor: 'initialization' stamp: 'Tomas 11/14/2024 23:58'!initialize         super initialize.        self color: Color blue.        self extent: 5 @ 10.		  velocidadProyectil := 6. ! !Morph subclass: #Invasor	instanceVariableNames: 'velocidad sprite rangoMovimiento posicionInicial'	classVariableNames: ''	poolDictionaries: ''	category: 'juegoSpaceInvaders'!!Invasor methodsFor: 'as yet unclassified' stamp: 'TomasRodriguez 11/12/2024 03:53'!cambiarPosicion: posicion	self position: self position + posicion! !!Invasor methodsFor: 'as yet unclassified' stamp: 'TomasRodriguez 11/12/2024 03:38'!createSprite    "Cargar y mostrar la imagen de fondo"    sprite:= ImageMorph new.    sprite image: (Form fromFileNamed: 'SIEnemy.png').     sprite extent: 20 @ 10.    self addMorph: sprite.! !!Invasor methodsFor: 'initialization' stamp: 'Tomas 11/15/2024 02:25'!initialize         super initialize.        self createSprite.		  self color: Color transparent.        self extent: 15 @ 10.        self position: 0 @ 50. "Posici‚àö‚â•n inicial de un invasor"        velocidad := 2.		rangoMovimiento := 80.		posicionInicial:= self position x.! !Morph subclass: #Piloto	instanceVariableNames: 'sprite proyectiles'	classVariableNames: ''	poolDictionaries: ''	category: 'juegoSpaceInvaders'!!Piloto methodsFor: 'as yet unclassified' stamp: 'Tomas 11/14/2024 08:31'!disparar     | disparo |    disparo := Disparo new mover.    disparo position: self position + (7 @ 10).	(disparo position y < 0) ifTrue: [ self proyectiles remove: disparo ifAbsent: []. "Eliminar de la colección del jugador" 		disparo delete. "Eliminar disparos fuera de la pantalla" 		Transcript show: 'Disparo eliminado por salir de los límites en ', self position asString; cr. ]. 	Transcript show: 'Disparo movido a ', self position asString; cr. 	proyectiles add: disparo.    self owner addMorph: disparo.! !!Piloto methodsFor: 'as yet unclassified' stamp: 'TomasRodriguez 11/12/2024 03:31'!actualizarproyectiles do: [ : proyectil | proyectil mover.	 ].! !!Piloto methodsFor: 'as yet unclassified' stamp: 'Tomas 11/14/2024 08:26'!mover: direction    | newSelectedPosition |    newSelectedPosition := self position + direction.	self position: newSelectedPosition.		self changed: #bounds.! !!Piloto methodsFor: 'as yet unclassified' stamp: 'TomasRodriguez 11/12/2024 03:39'!createSprite    "Cargar y mostrar la imagen de fondo"    sprite:= ImageMorph new.    sprite image: (Form fromFileNamed: 'SIPlayer.png').     sprite extent: 20 @ 10.    self addMorph: sprite.! !!Piloto methodsFor: 'accessing' stamp: 'TomasRodriguez 11/12/2024 04:08'!proyectiles^proyectiles! !!Piloto methodsFor: 'initialization' stamp: 'Tomas 11/15/2024 02:22'!initialize	super initialize.	self color: Color transparent.        self createSprite.        self position: 300 @ 450. 	proyectiles:= OrderedCollection new.! !Morph subclass: #SpaceInvaders	instanceVariableNames: 'jugador invasores disparosJugador background puntaje margenDerecho'	classVariableNames: ''	poolDictionaries: ''	category: 'juegoSpaceInvaders'!!SpaceInvaders methodsFor: 'accessing' stamp: 'Tomas 11/15/2024 02:39'!puntaje^puntaje! !!SpaceInvaders methodsFor: 'initialization' stamp: 'Tomas 11/15/2024 02:37'!initialize     | posicionArriba posicionAbajo |    super initialize.	        "Configurar la ventana del juego y abrirla en el mundo"    self extent: 640 @ 640.    self createBackground.    self openInWorld.    "Colecciones de invasores y disparos"    invasores := OrderedCollection new.    disparosJugador := OrderedCollection new.	puntaje:= 0.    "Inicializar el jugador y agregarlo al mundo"    jugador := Piloto new.    self addMorph: jugador.    self takeKeyboardFocus.    "Posiciones iniciales para los invasores"    posicionArriba := 100 @ 0.    posicionAbajo := 100 @ 100.    "Agregar invasores en filas usando m√©todos de configuraci√≥n"    self crearFilaInvasoresEn: posicionArriba conCantidad: 5 desplazamiento: 100 @ 0.    self crearFilaInvasoresEn: posicionAbajo conCantidad: 5 desplazamiento: 100 @ 0.    "Iniciar el juego y actualizar continuamente"    self iniciarSI.	self detectarColision.	self detectarColisionJugador.! !!SpaceInvaders methodsFor: 'as yet unclassified' stamp: 'Tomas 11/15/2024 02:39'!detectarColisionJugador    |  bounds_jugador |	margenDerecho:= 50.    bounds_jugador := jugador bounds.  "Obtenemos las coordenadas y el tamaño del jugador"        "Verificar si algún invasor toca al jugador"    invasores do: [ :invader |        | bounds_invader |        bounds_invader := invader bounds.                ((bounds_jugador right >= bounds_invader left and: [bounds_jugador left <= (bounds_invader right + margenDerecho)])                and: [(bounds_jugador bottom >= bounds_invader top and: [bounds_jugador top <= bounds_invader bottom])])                ifTrue: [ 	puntaje:= 0.	 self delete.			].]! !!SpaceInvaders methodsFor: 'as yet unclassified' stamp: 'Tomy 11/12/2024 19:34'!crearFilaInvasoresEn: posicionInicial conCantidad: cantidad desplazamiento: desplazamiento     | posicionActual |    posicionActual := posicionInicial.  "Crear una variable local para almacenar la posici√≥n actual"        cantidad timesRepeat: [        | invader |        invader := Invasor new.        invader cambiarPosicion: posicionActual.        invasores add: invader.        self addMorph: invader.        posicionActual := posicionActual + desplazamiento.  "Actualizar la posici√≥n actual"    ].! !!SpaceInvaders methodsFor: 'as yet unclassified' stamp: 'Tomas 11/15/2024 02:34'!iniciarSI    "Iniciar el desplazamiento de invasores en un hilo separado"    self desplazarInvasores.        "Ciclo principal del juego"    [        [            self detectarColision.				self detectarColisionJugador.            self updateGame.            (Delay forMilliseconds: 40) wait.        ] repeat    ] fork.! !!SpaceInvaders methodsFor: 'as yet unclassified' stamp: 'Tomas 11/15/2024 02:29'!detectarColision    | disparosAEliminar invasoresAEliminar bounds_bala bounds_invader |    disparosAEliminar := OrderedCollection new.    invasoresAEliminar := OrderedCollection new.        "Define un margen adicional hacia la derecha"    margenDerecho := 50. "Ajusta este valor según el área extra que quieras detectar"    jugador proyectiles do: [:disparo |        bounds_bala := disparo bounds.        invasores do: [:invader |            bounds_invader := invader bounds.            "Expande el límite derecho del invasor para ampliar el área de colisión"            ((bounds_bala right >= bounds_invader left and: [bounds_bala left <= (bounds_invader right + margenDerecho)])                and: [(bounds_bala bottom >= bounds_invader top and: [bounds_bala top <= bounds_invader bottom])])                ifTrue: [                    disparosAEliminar add: disparo.                    invasoresAEliminar add: invader.                    Transcript show: 'Colisión detectada entre disparo en ', disparo position asString, ' e invader en ', invader position asString; cr.                    puntaje := puntaje + 1.                ].        ].    ].    "Eliminar todos los disparos e invasores detectados de una vez"    jugador proyectiles removeAll: disparosAEliminar.    disparosAEliminar do: [:disparo |        disparo delete. "Eliminar de la vista"        Transcript show: 'Disparo eliminado'; cr.    ].    invasores removeAll: invasoresAEliminar.    invasoresAEliminar do: [:invader |        invader delete. "Eliminar de la vista"        Transcript show: 'Invader eliminado'; cr.    ].    "Paso opcional: Limpiar variables temporales"    disparosAEliminar := nil.    invasoresAEliminar := nil.! !!SpaceInvaders methodsFor: 'as yet unclassified' stamp: 'TomasRodriguez 11/12/2024 02:46'!handlesKeyboard    ^ true! !!SpaceInvaders methodsFor: 'as yet unclassified' stamp: 'Tomas 11/15/2024 02:02'!updateGame jugador proyectiles do: [:disparo |	disparo position y > 0 ifTrue: [ disparo mover. self detectarColision.]	ifFalse: [ jugador proyectiles remove: disparo. ].	]. self changed: #bounds.! !!SpaceInvaders methodsFor: 'as yet unclassified' stamp: 'Tomas 11/15/2024 02:44'!desplazarInvasores    [        [            invasores do: [:invader |                 | desplazamientoY |                desplazamientoY := 4. "Desplazamiento hacia abajo"                invader position: invader position + (0 @ desplazamientoY).            ].            (Delay forSeconds: 1) wait.  "Ajuste la velocidad de movimiento"        ] repeat    ] fork.! !!SpaceInvaders methodsFor: 'as yet unclassified' stamp: 'TomasRodriguez 11/12/2024 02:21'!createBackground    "Cargar y mostrar la imagen de fondo"    background:= ImageMorph new.    background image: (Form fromFileNamed: 'SIBackground.png').     background extent: 640 @ 640.	background bounds: (0 @ 0 corner: 640 @ 640).    self extent: 640 @ 640.  "Ajusta el tama‚àö¬±o del men‚àö‚à´"    self addMorph: background.! !!SpaceInvaders methodsFor: 'event handling' stamp: 'Tomas 11/14/2024 23:47'!handleKeystroke: anEvent    anEvent keyValue caseOf: {        [28] -> [jugador mover: (-6 @ 0)].  "Izquierda"        [29] -> [jugador mover: (6 @ 0)].   "Derecha"			[30] -> [jugador disparar].  "Arriba"    } otherwise: [].! !